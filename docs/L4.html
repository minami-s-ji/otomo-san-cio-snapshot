<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Otomosan Snapshot</title>
    <style>
      body {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        padding: 16px;
      }
      pre {
        white-space: pre-wrap;
        word-break: break-word;
        line-height: 1.5;
      }
      .meta {
        color: #666;
        font-size: 12px;
        margin-bottom: 12px;
      }
    </style>
  </head>
  <body>
    <div class="meta">generated by GitHub Actions</div>
    <pre id="content">L4｜作業状態・中断ポイント（超頻繁・完全）
最終更新日時2025-12-24
更新方式：固定フレーム保持＋差分追記
主開発テーマ（削除禁止・継続中）
おともさん経営アシスタントAI 開発
フェーズ：フェーズ0（基礎データ整備）
主対象：
商品マスタ自動生成ワークフロー
Dify Workflow 構成
LLM 出力安定性の確保
直前まで進めていた主作業（中断中）
商品マスタ自動生成WFの精度・安定性改善検討
LLMプロンプト設計とWF構成の棚卸し
合意済み・未解消懸念（固定リスト）
Systemプロンプト内の例示による JSON 構文破壊リスク
仮説系配列フィールドの出力暴走リスク
「カテゴリ：不明」固定ルールが将来破られる可能性
※ 本リストは削除禁止
※ 解消した場合は「解消済み」に明示的に移動すること
今回の作業で確定・更新された状態（差分）
解消／部分解消された事項
JSON構文破壊リスク（①）について
Dify Workflow において
LLM 出力（text）→ コード実行 → CSV生成
がエラーなく完走する構成が確定
壊れた JSON は _raw として検知可能な状態
→ フェーズ0における実運用上の停止リスクは低減
※ Systemプロンプト内例示そのもののリスクは残存
（完全解消ではなく「部分解消」）
未解消のまま残っている事項（再確認）
② 仮説系配列フィールドの出力暴走リスク
未着手
次の主作業対象
③「カテゴリ：不明」固定ルールの将来破綻リスク
未着手
後続フェーズで扱う前提
今回確定した設計判断（事実のみ）
ターゲット仮説の設計方針が確定
ターゲット仮説：ハイブリッド型
位置づけ：
後段の分析エージェントが更新・昇格する前提の初期仮説
構成ルール：
セグメント名
固定候補リストから選択
新規作成・言い換え禁止
表記完全一致
利用文脈
短文・自由生成
1文
40文字以内
セグメント名と意味的に矛盾しない
件数：
1〜2件
原則1件
利用文脈が明確に異なる場合のみ2件目
迷った場合は必ず減らす
上記を反映した Systemプロンプト追記文が確定済み
次回再開時の最初の一手（最優先）
ターゲット仮説の System プロンプト追記文を LLM2 に反映
テスト実行し、出力件数（1〜2件）が安定していることを確認
次の主作業として
「仮説系配列フィールドの出力暴走リスク（②）」への対処に着手
対象例：
売れ方の傾向
価格・心理距離
説明必要度
セット相性
2025-12-21 01:06
主開発テーマ（削除禁止・継続中）
おともさん経営アシスタントAI 開発
フェーズ：フェーズ0（基礎データ整備）
主対象：
商品マスタ自動生成ワークフロー
Dify Workflow 構成
LLM 出力安定性の確保
直前まで進めていた主作業（中断中）
商品マスタ自動生成WFの精度・安定性改善検討
LLMプロンプト設計とWF構成の棚卸し
以下の懸念が未解消のまま残っている（合意済み）：
Systemプロンプト内の例示による JSON 構文破壊リスク
仮説系配列フィールドの出力暴走リスク
「カテゴリ：不明」固定ルールが将来破られる可能性
主開発を一時中断した理由（割り込み作業）
ChatGPT / 外部CIO が再起動した際に、
文脈
判断軸
作業状態
が失われるリスクが顕在化
再起動後に 即フルスロットルで再開できる状態 を作る必要があったため、
スナップショット（L1〜L5）を外部参照可能にするプロトコル構築 を優先
割り込み対応として実施した作業（完了）
Notion に保存した L1〜L5 を
GitHub Actions（30分周期）
Playwright
により自動取得
Notion 公開ページの不安定挙動（初期描画が空になる等）を観測
waitForFunction + retry を用いた取得戦略を実装
GitHub Pages 上に
L1.html〜L5.html
を固定URLで公開
再起動時に URLを渡すだけで文脈復元できる状態 に到達
現在の状態（重要）
再起動プロトコル構築：完了
主開発（おともさん経営アシスタントAI）：再開可能状態
GitHub / スナップショット基盤は、
当面触らない前提の「安定基盤」として扱う
次回再開時の最初の一手（主開発へ戻る）
フェーズ0に戻り、
商品マスタ自動生成WFの出力安定化 から再開
L5 に記録済みの
LLM出力揺れ
JSON破壊リスク
を前提条件として設計を進める</pre>
  </body>
</html>
